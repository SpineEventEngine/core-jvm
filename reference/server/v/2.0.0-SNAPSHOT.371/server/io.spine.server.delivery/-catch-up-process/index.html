<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>CatchUpProcess</title>
    <link href="../../../images/logo-icon.svg" rel="icon" type="image/svg">
        <script>var pathToRoot = "../../../";</script>
    <script>document.documentElement.classList.replace("no-js", "js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
      if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
          document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
      } else {
        const savedDarkMode = JSON.parse(storage)
        if (savedDarkMode === true) {
          document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
      }
    </script>
<script type="text/javascript" src="https://unpkg.com/kotlin-playground@1/dist/playground.min.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/sourceset_dependencies.js" async="async"></script>
<link href="../../../styles/style.css" rel="Stylesheet">
<link href="../../../styles/main.css" rel="Stylesheet">
<link href="../../../styles/prism.css" rel="Stylesheet">
<link href="../../../styles/logo-styles.css" rel="Stylesheet">
<link href="../../../ui-kit/ui-kit.min.css" rel="Stylesheet">
<script type="text/javascript" src="../../../scripts/safe-local-storage_blocking.js"></script>
<script type="text/javascript" src="../../../scripts/navigation-loader.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/platform-content-handler.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/main.js" defer="defer"></script>
<script type="text/javascript" src="../../../scripts/prism.js" async="async"></script>
<script type="text/javascript" src="../../../ui-kit/ui-kit.min.js" defer="defer"></script>
<link href="../../../images/logo-icon.svg">
<link href="../../../styles/custom-styles.css" rel="Stylesheet">
</head>
<body>
<div class="root">
    <header class="navigation theme-dark" id="navigation-wrapper" role="banner">
            <a class="library-name--link" href="../../../index.html" tabindex="1">
                    server
            </a>
        <button class="navigation-controls--btn navigation-controls--btn_toc ui-kit_mobile-only" id="toc-toggle"
                type="button">Toggle table of contents
        </button>
        <div class="navigation-controls--break ui-kit_mobile-only"></div>
        <div class="library-version" id="library-version">
2.0.0-SNAPSHOT.371        </div>
        <div class="navigation-controls">
        <ul class="filter-section filter-section_loading" id="filter-section" aria-label="Target filter">
                <button class="platform-tag platform-selector jvm-like" data-active="" aria-pressed="true"
                        data-filter=":server/main">jvm</button>
            <div class="dropdown filter-section--dropdown" data-role="dropdown" id="filter-section-dropdown">
                <button class="button button_dropdown filter-section--dropdown-toggle" role="combobox"
                        data-role="dropdown-toggle"
                        aria-controls="platform-tags-listbox"
                        aria-haspopup="listbox"
                        aria-expanded="false"
                        aria-label="Toggle source sets"
                ></button>
                <ul role="listbox" id="platform-tags-listbox" class="dropdown--list" data-role="dropdown-listbox" aria-label="Target filter">
                    <div class="dropdown--header"><span>Target filter</span>
                        <button class="button" data-role="dropdown-toggle" aria-label="Close target filter">
                            <i class="ui-kit-icon ui-kit-icon_cross"></i>
                        </button>
                    </div>
                        <li role="option" class="dropdown--option platform-selector-option jvm-like" tabindex="0">
                            <label class="checkbox">
                                <input type="checkbox" class="checkbox--input" id=":server/main"
                                       data-filter=":server/main"/>
                                <span class="checkbox--icon"></span>
                                jvm
                            </label>
                        </li>
                </ul>
                <div class="dropdown--overlay"></div>
            </div>
        </ul>
            <button class="navigation-controls--btn navigation-controls--btn_theme" id="theme-toggle-button"
                    type="button">Switch theme
            </button>
            <div class="navigation-controls--btn navigation-controls--btn_search" id="searchBar" role="button">Search in
                API
            </div>
        </div>
    </header>
    <div id="container">
        <nav id="leftColumn" class="sidebar" data-item-type="SECTION" data-item-config='{"defaultSize": 280, "minSize": 200, "maxSize": 400}'>
            <a class="toc--skip-link" href="#main">Skip to content</a>
            <div class="dropdown theme-dark_mobile" data-role="dropdown" id="toc-dropdown">
                <ul role="listbox" id="toc-listbox" class="dropdown--list dropdown--list_toc-list"
                    data-role="dropdown-listbox" aria-label="Table of contents">
                    <div class="dropdown--header">
                            <span>
                                    server
                            </span>
                        <button class="button" data-role="dropdown-toggle" aria-label="Close table of contents">
                            <i class="ui-kit-icon ui-kit-icon_cross"></i>
                        </button>
                    </div>
                    <div class="sidebar--inner" id="sideMenu"></div>
                </ul>
                <div class="dropdown--overlay"></div>
            </div>
        </nav>
        <div id="resizer" class="resizer" data-item-type="BAR"></div>
        <div id="main" data-item-type="SECTION" role="main">
<div class="main-content" data-page-type="classlike" id="content" pageIds="server::io.spine.server.delivery/CatchUpProcess///PointingToDeclaration//332232451">
  <div class="breadcrumbs"><a href="../../../index.html">server</a><span class="delimiter">/</span><a href="../index.html">io.spine.server.delivery</a><span class="delimiter">/</span><span class="current">CatchUpProcess</span></div>
  <div class="cover ">
    <h1 class="cover"><span>Catch</span><wbr></wbr><span>Up</span><wbr></wbr><span><span>Process</span></span></h1>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server/main"><div class="symbol monospace"><span class="token keyword">class </span><a href="index.html">CatchUpProcess</a><span class="token operator">&lt;</span><a href="index.html">I</a><span class="token operator">&gt;</span> : <a href="../../io.spine.server.event/-abstract-stateful-reactor/index.html">AbstractStatefulReactor</a><span class="token operator">&lt;</span><a href="../-catch-up-id/index.html">CatchUpId</a><span class="token punctuation">, </span><a href="../-catch-up/index.html">CatchUp</a><span class="token punctuation">, </span><a href="../-catch-up/-builder/index.html">CatchUp.Builder</a><span class="token operator">&gt; </span></div><p class="paragraph">A process that performs a projection catch-up. </p><p class="paragraph">Starts the catch-up process by emitting the <span data-unresolved-link="io.spine.server.delivery.event/CatchUpRequested///PointingToDeclaration/">CatchUpRequested</span> event. </p><p class="paragraph">Has its own <span data-unresolved-link="io.spine.server.delivery/Inbox///PointingToDeclaration/">Inbox</span>, so the messages arriving to it are dispatched by the <a href="../-delivery/index.html">Delivery</a>. </p><p class="paragraph">While recalling the event history, the process relies on the work of <code class="lang-kotlin">Delivery</code>, which follows the status of the process and delivers messages in <code class="lang-kotlin">TO_CATCH_UP</code> status instead of live <code class="lang-kotlin">TO_DELIVER</code> messages to the catching-up targets. </p><p class="paragraph">The tricky part is so called &quot;turbulence&quot; period, i.e. the time when the catch-up comes close to the current time in the event history. In this phase the task is to understand when to stop reading the history and switch back to delivering the live events dispatched to the catching-up projections. To do so, a special <code class="lang-kotlin">FINALIZING</code> status is introduced. Observed by <code class="lang-kotlin">Delivery</code> it tells to perform a transition from dispatching <code class="lang-kotlin">TO_CATCH_UP</code> events back to delivering those <code class="lang-kotlin">TO_DELIVER</code>. See more on that below. </p><p class="paragraph">In this version of the process implementation, the turbulence period always equals 500 ms meaning that the catch-up starts its finalization when the event history is read up until <code class="lang-kotlin">now - 500 ms</code>. </p><p class="paragraph">In its lifecycle, the process moves through the several statuses. </p><h3 class=""><a href="../-catch-up-status/-c-u-s_-u-n-d-e-f-i-n-e-d/index.html">Not started</a></h3><p class="paragraph">The process is created in this status upon receiving the <code class="lang-kotlin">CatchUpRequested</code> event. The further actions include: </p><ol><li>A <span data-unresolved-link="io.spine.server.delivery.event/CatchUpStarted///PointingToDeclaration/">CatchUpStarted</span> event is emitted. The target projection repository listens to this event and kills the state of the matching entities. </li><li>The status if the catch-up process is set to <a href="../-catch-up-status/-i-n_-p-r-o-g-r-e-s-s/index.html">IN_PROGRESS</a>. </li></ol><h3 class=""><a href="../-catch-up-status/-s-t-a-r-t-e-d/index.html">STARTED</a></h3><p class="paragraph">The process is created in this status upon receiving the <code class="lang-kotlin">CatchUpRequested</code> event. The further actions include: </p><ol><li>A <span data-unresolved-link="io.spine.server.delivery.event/CatchUpStarted///PointingToDeclaration/">CatchUpStarted</span> event is emitted. The target projection repository listens to this event and kills the state of the matching entities. </li><li>The status if the catch-up process is set to <a href="../-catch-up-status/-i-n_-p-r-o-g-r-e-s-s/index.html">IN_PROGRESS</a>. </li></ol><h3 class=""><a href="../-catch-up-status/-i-n_-p-r-o-g-r-e-s-s/index.html">IN_PROGRESS</a></h3><p class="paragraph">When the process is in this status, the event history is read and the matching events are sent to the <code class="lang-kotlin">Inbox</code>es of the corresponding projections </p><p class="paragraph">The catch-up maintains this status until the history is read till the point in time, which is very close to the <span data-unresolved-link="io.spine.base/Time/currentTime/#/PointingToDeclaration/">Time.currentTime()</span>. When this time comes, the events arriving to the <code class="lang-kotlin">EventStore</code> are very likely to be just-emitted in a live mode. Therefore, the process needs to decide whether to decide that the history is fully read, or to continue the traversal through the history. </p><p class="paragraph">At this stage the actions are as follows. </p><ol><li>The historical event messages are read from the <a href="../../io.spine.server.event/-event-store/index.html">EventStore</a> respecting the time range requested and the time of the last read operation performed by this process. The maximum number of the events read is determined by <a href="../-delivery-builder/set-catch-up-page-size.html">one of the Delivery settings</a>. </li><li>Depending on the targets requested for the catch-up, the events are posted to the corresponding entities. </li><li>Unless the timestamps of the events are getting close to the current time, an <span data-unresolved-link="io.spine.server.delivery.event/HistoryEventsRecalled///PointingToDeclaration/">HistoryEventsRecalled</span> is emitted, leaving the process in the <code class="lang-kotlin">IN_PROGRESS</code> status and triggering the next round similar to this one. <p class="paragraph">If the timestamps of the events read on this step are as close to the current time as the turbulence period, the <span data-unresolved-link="io.spine.server.delivery.event/HistoryFullyRecalled///PointingToDeclaration/">HistoryFullyRecalled</span> is emitted. </p></li></ol><h3 class=""><a href="../-catch-up-status/-f-i-n-a-l-i-z-i-n-g/index.html">FINALIZING</a></h3><p class="paragraph">The process moves to this status when the event history has been fully recalled and the corresponding <code class="lang-kotlin">HistoryFullyRecalled</code> is received. At this stage, the <code class="lang-kotlin">Delivery</code> stops the propagation of the events to the catch-up messages, waiting for this process to populate the inboxes with the messages arriving to be dispatched during the turbulence period. Potentially, the inboxes will contain the duplicates produced by both the live users and this process. To deal with it, a deduplication is performed by the <code class="lang-kotlin">Delivery</code>. See <span data-unresolved-link="io.spine.server.delivery/CatchUpStation///PointingToDeclaration/">CatchUpStation</span> for more details. </p><p class="paragraph">The historical data pushed by the catch-up is dispatched through a number of shards, each processed by the <code class="lang-kotlin">Delivery</code> independently of each other. Starting to dispatch the events from a shard, <code class="lang-kotlin">Delivery</code> reads the details of the ongoing catch-up processes. By interpreting the status of each catch-up, <code class="lang-kotlin">Delivery</code> decides on the actions to apply to the historical events. For instance, the historical events dispatched from a catch-up which is already <code class="lang-kotlin">COMPLETED</code> are considered junk and are immediately deleted. </p><p class="paragraph">Before moving to the catch-up completion, it is required to make sure every historical event has been seen and dispatched by the <code class="lang-kotlin">Delivery</code>. So if the catch-up process is moved to the <code class="lang-kotlin">COMPLETED</code> state too early, some historical events will get stuck in limbo, and will eventually be deleted. </p><p class="paragraph">It's important to understand that different shards may be processed at different speeds and potentially by different application nodes. Therefore, in order to switch to the <code class="lang-kotlin">COMPLETED</code> status, a catch-up process must ensure that <strong>each</strong> shard was processed by the <code class="lang-kotlin">Delivery</code> which witnessed the catch-up process in its <code class="lang-kotlin">FINALIZING</code> state. Such evidence would mean that this <code class="lang-kotlin">Delivery</code> run is at the point in time by which three things already happened: </p><ol><li>the catch-up process has emitted all the events from the history, </li><li>the catch-up process has sent <span data-unresolved-link="io.spine.server.delivery.event/HistoryFullyRecalled///PointingToDeclaration/">HistoryFullyRecalled</span> after the historical events, </li><li>all these events were dispatched already â€” otherwise, the process wasn't going to be in its <code class="lang-kotlin">FINALIZING</code> state. </li></ol><p class="paragraph">In order to guarantee that prior to moving to the <code class="lang-kotlin">COMPLETED</code> status, the catch-up process emits special <span data-unresolved-link="io.spine.server.delivery.event/ShardProcessingRequested///PointingToDeclaration/">ShardProcessingRequested</span> events for each shard. The events are dispatched to a <span data-unresolved-link="io.spine.server.delivery/ShardMaintenanceProcess///PointingToDeclaration/">ShardMaintenanceProcess</span>, which responds back by emitting <span data-unresolved-link="io.spine.server.delivery.event/ShardProcessed///PointingToDeclaration/">ShardProcessed</span> events. The <code class="lang-kotlin">Delivery</code> knows about this special-case signals and appends the data in these events with its own picture of ongoing catch-up processes and their statuses. By receiving <code class="lang-kotlin">ShardProcessed</code> events populated with this information the catch-up process knows which status was seen by the <code class="lang-kotlin">Delivery</code> at the moment when it had been dispatching the events from a certain shard. </p><p class="paragraph">The actions at this stage are as follows. </p><ol><li>All the remaining messages of the matching event types are read <a href="../../io.spine.server.event/-event-store/index.html">EventStore</a>. In this operation the read limits set by the <code class="lang-kotlin">Delivery</code> are NOT used, since the goal is to read the remainder of the events. </li><li>The <span data-unresolved-link="io.spine.server.delivery.event/LiveEventsPickedUp///PointingToDeclaration/">LiveEventsPickedUp</span> event is emitted. This allows some time for the posted events to become visible to the <code class="lang-kotlin">Delivery</code>. </li><li>In the next round of delivery, the emitted <span data-unresolved-link="io.spine.server.delivery.event/LiveEventsPickedUp///PointingToDeclaration/">LiveEventsPickedUp</span> event is dispatched back to this process. By this time, the last batch of the historical events has already been sent to their destinations. However, not all of them may have been yet delivered due to their large number or to the I/O performance. To ensure that every historical event was seen by the <code class="lang-kotlin">Delivery</code>, a special <span data-unresolved-link="io.spine.server.delivery.event/ShardProcessingRequested///PointingToDeclaration/">ShardProcessingRequested</span> event is emitted for every shard involved into dispatching the historical events up until now. </li><li>Each <span data-unresolved-link="io.spine.server.delivery.event/ShardProcessingRequested///PointingToDeclaration/">ShardProcessingRequested</span> event triggers the <code class="lang-kotlin">Delivery</code> to read and dispatch the signals from a specific shard. Being sent, these events are dispatched to a special system <span data-unresolved-link="io.spine.server.delivery/ShardMaintenanceProcess///PointingToDeclaration/">ShardMaintenanceProcess</span> serving as a handler. By reacting to a <code class="lang-kotlin">ShardProcessingRequested</code>, the latter maintenance process emits a <span data-unresolved-link="io.spine.server.delivery.event/ShardProcessed///PointingToDeclaration/">ShardProcessed</span> event, telling that the <code class="lang-kotlin">Delivery</code> has worked its way through the messages present in this shard. </li><li>The catch-up process handles each <code class="lang-kotlin">ShardProcessed</code> event. By gathering the data from these events, the catch-up is able to tell when all the affected shards were fully processed by the <code class="lang-kotlin">Delivery</code>. Once all shards are processed, a <span data-unresolved-link="io.spine.server.delivery.event/CatchUpCompleted///PointingToDeclaration/">CatchUpCompleted</span> event is emitted. </li></ol><h3 class=""><a href="../-catch-up-status/-c-o-m-p-l-e-t-e-d/index.html">COMPLETED</a></h3><p class="paragraph">Once the <code class="lang-kotlin">CatchUpCompleted</code> event is received, the process moves to the <code class="lang-kotlin">COMPLETED</code> status. At this point, some live events and some historical events which were located in the &quot;turbulence&quot; window are still paused for dispatching. To ensure they are processed in each shard, the catch-up emits a number of <code class="lang-kotlin">ShardProcessingRequested</code> events again. By dispatching them, it makes sure that the <code class="lang-kotlin">Delivery</code> observes the change of catch-up status to <code class="lang-kotlin">COMPLETED</code> and moves onto de-duplicating and delivering the previously &quot;paused&quot; events. </p><p class="paragraph">After that, a normal delivery flow is resumed. The catch-up process stops its execution.</p><h4 class="tableheader">Parameters</h4><div class="table"><div class="table-row table-row_content" data-filterable-current=":server/main" data-filterable-set=":server/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span><span>&lt;I&gt;</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the type of identifiers of the processed projections</p></div></div></div></div></div></div></div>
  </div>
  <div class="tabbedcontent">
    <div class="tabs-section" tabs-section="tabs-section"><button class="section-tab" data-active="" data-togglable="CONSTRUCTOR,TYPE,PROPERTY,FUNCTION">Members</button></div>
    <div class="tabs-section-body">
      <div data-togglable="TYPE">
        <h2 class="tableheader">Types</h2>
        <div class="table"><a data-name="181623235%2FClasslikes%2F332232451" anchor-label="DispatchCatchingUp" id="181623235%2FClasslikes%2F332232451" data-filterable-set=":server/main"></a>
          <div class="table-row table-row_content" data-filterable-current=":server/main" data-filterable-set=":server/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="-dispatch-catching-up/index.html"><span>Dispatch</span><wbr></wbr><span>Catching</span><wbr></wbr><span><span>Up</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="181623235%2FClasslikes%2F332232451"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server/main"><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@</span><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/FunctionalInterface.html"><span class="token annotation builtin">FunctionalInterface</span></a></div></div><span class="token keyword">interface </span><a href="-dispatch-catching-up/index.html">DispatchCatchingUp</a><span class="token operator">&lt;</span><a href="-dispatch-catching-up/index.html">I</a><span class="token operator">&gt;</span></div><div class="brief ">A method object dispatching the event to catch-up.</div></div></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div data-togglable="FUNCTION">
        <h2 class="tableheader">Functions</h2>
        <div class="table"><a data-name="-1158532712%2FFunctions%2F332232451" anchor-label="canDispatch" id="-1158532712%2FFunctions%2F332232451" data-filterable-set=":server/main"></a>
          <div class="table-row table-row_content" data-filterable-current=":server/main" data-filterable-set=":server/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="can-dispatch.html"><span>can</span><wbr></wbr><span><span>Dispatch</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-1158532712%2FFunctions%2F332232451"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server/main"><div class="symbol monospace"><span class="token keyword">open </span><span class="token keyword">fun </span><a href="can-dispatch.html"><span class="token function">canDispatch</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">envelope<span class="token operator">: </span><a href="../../io.spine.server.type/-event-envelope/index.html">EventEnvelope</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin/-boolean/index.html">Boolean</a></div><div class="brief ">Checks if this dispatcher can dispatch the given message.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="-650767915%2FFunctions%2F332232451" anchor-label="load" id="-650767915%2FFunctions%2F332232451" data-filterable-set=":server/main"></a>
          <div class="table-row table-row_content" data-filterable-current=":server/main" data-filterable-set=":server/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="load.html"><span><span>load</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-650767915%2FFunctions%2F332232451"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server/main"><div class="symbol monospace"><span class="token keyword">protected </span><span class="token keyword">open </span><span class="token keyword">fun </span><a href="load.html"><span class="token function">load</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">id<span class="token operator">: </span><a href="../-catch-up-id/index.html">CatchUpId</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html">Optional</a><span class="token operator">&lt;</span><a href="../-catch-up/index.html">CatchUp</a><span class="token operator">&gt;</span></div><div class="brief ">Loads the state from the storage by ID.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="-930772335%2FFunctions%2F332232451" anchor-label="newStateBuilderWith" id="-930772335%2FFunctions%2F332232451" data-filterable-set=":server/main"></a>
          <div class="table-row table-row_content" data-filterable-current=":server/main" data-filterable-set=":server/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="new-state-builder-with.html"><span>new</span><wbr></wbr><span>State</span><wbr></wbr><span>Builder</span><wbr></wbr><span><span>With</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-930772335%2FFunctions%2F332232451"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server/main"><div class="symbol monospace"><span class="token keyword">protected </span><span class="token keyword">open </span><span class="token keyword">fun </span><a href="new-state-builder-with.html"><span class="token function">newStateBuilderWith</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">id<span class="token operator">: </span><a href="../-catch-up-id/index.html">CatchUpId</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="../-catch-up/-builder/index.html">CatchUp.Builder</a></div><div class="brief ">Creates a new instance of the respective state <span data-unresolved-link="io.spine.validation/ValidatingBuilder///PointingToDeclaration/">ValidatingBuilder</span> and sets the passed identifier to it.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="-279932263%2FFunctions%2F332232451" anchor-label="route" id="-279932263%2FFunctions%2F332232451" data-filterable-set=":server/main"></a>
          <div class="table-row table-row_content" data-filterable-current=":server/main" data-filterable-set=":server/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="route.html"><span><span>route</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-279932263%2FFunctions%2F332232451"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server/main"><div class="symbol monospace"><span class="token keyword">protected </span><span class="token keyword">open </span><span class="token keyword">fun </span><a href="route.html"><span class="token function">route</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">event<span class="token operator">: </span><a href="../../io.spine.server.type/-event-envelope/index.html">EventEnvelope</a></span></span><span class="token punctuation">)</span><span class="token operator">: </span><span data-unresolved-link="com.google.common.collect/ImmutableSet///PointingToDeclaration/">ImmutableSet</span><span class="token operator">&lt;</span><a href="../-catch-up-id/index.html">CatchUpId</a><span class="token operator">&gt;</span></div><div class="brief ">Selects the target to which the event should be dispatched.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="-1008919077%2FFunctions%2F332232451" anchor-label="store" id="-1008919077%2FFunctions%2F332232451" data-filterable-set=":server/main"></a>
          <div class="table-row table-row_content" data-filterable-current=":server/main" data-filterable-set=":server/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="store.html"><span><span>store</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-1008919077%2FFunctions%2F332232451"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server/main"><div class="symbol monospace"><span class="token keyword">protected </span><span class="token keyword">open </span><span class="token keyword">fun </span><a href="store.html"><span class="token function">store</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">updatedState<span class="token operator">: </span><a href="../-catch-up/index.html">CatchUp</a></span></span><span class="token punctuation">)</span></div><div class="brief ">Stores the passed state in the storage.</div></div></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
    <div class="footer">
        <div class="footer--container">
            <a href="#content" id="go-to-top-link" class="footer--button footer--button_go-to-top"></a>
            <div class="footer--content">
                <div>
                    <span>Generated by </span>
                    <a class="footer--link footer--link_external" href="https://github.com/Kotlin/dokka">
                        Dokka
                    </a>
                    <div>Copyright 2025, TeamDev</div>
                </div>
            </div>
        </div>
    </div>
        </div>
    </div>
</div>
</body>
</html>